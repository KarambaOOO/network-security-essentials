# –ì–ª–∞–≤–∞ 3 ‚Äî Message Authentication (—à–ø–∞—Ä–≥–∞–ª–∫–∞)

–¶–µ–ª—å: –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä—è—Ç—å **—Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å** –∏ **–ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å** —Å–æ–æ–±—â–µ–Ω–∏–π (MAC), –∏ –≥–¥–µ —Ç—É—Ç HMAC / CMAC / CCM.

---

## 3.1 –ü–æ–¥—Ö–æ–¥—ã –∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

### 1) –ß–µ—Ä–µ–∑ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (conventional encryption)
–ò–¥–µ—è: —à–∏—Ñ—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ (–∏–ª–∏ –µ–≥–æ –¥–∞–π–¥–∂–µ—Å—Ç) –æ–±—â–∏–º –∫–ª—é—á–æ–º ‚Üí –ø–æ–ª—É—á–∞—Ç–µ–ª—å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –∏ —Å–≤–µ—Ä—è–µ—Ç.
- –ü–ª—é—Å: –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å.
- –ú–∏–Ω—É—Å: –¥–æ—Ä–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞—Ç—å –≤—Å—ë, –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏/–ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏.

### 2) –ë–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è
–ù—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ ¬´—Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å + –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å¬ª, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–µ —Å–∫—Ä—ã–≤–∞–µ–º.
- –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Å—É–º–º—ã/CRC ‚Üí **–Ω–µ –∫—Ä–∏–ø—Ç–æ—Å—Ç–æ–π–∫–∏–µ** (–ª–∏–Ω–µ–π–Ω—ã–µ).
- –ö—Ä–∏–ø—Ç–æ-—Ö–µ—à (SHA-2) –¥–∞—ë—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å, –Ω–æ **–±–µ–∑ –∫–ª—é—á–∞** –∞—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –ø–æ–¥–¥–µ–ª–∞—Ç—å.
- –í—ã–≤–æ–¥: –ù—É–∂–µ–Ω **MAC = F(K, M)** (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–ª—é—á–∞ K –∏ —Å–æ–æ–±—â–µ–Ω–∏—è M).

---

# üìò –ì–ª–∞–≤–∞ 3.2 ‚Äî Secure Hash Functions 

---

## üîπ –ß—Ç–æ —Ç–∞–∫–æ–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏—è
–§—É–Ω–∫—Ü–∏—è H(M), –∫–æ—Ç–æ—Ä–∞—è:
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã M.
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–π–¥–∂–µ—Å—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã h = H(M).
- –í—Å–µ–≥–¥–∞ –¥–∞—ë—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ M.
- –ë—ã—Å—Ç—Ä–∞—è –∏ –ª–µ–≥–∫–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –≤ —Å–æ—Ñ—Ç–µ/–∂–µ–ª–µ–∑–µ.

---

## üîπ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (3 —É—Ä–æ–≤–Ω—è)
1. **Preimage resistance** (—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –ø—Ä–æ–æ–±—Ä–∞–∑—É)  
   - –ù–µ–ª—å–∑—è –Ω–∞–π—Ç–∏ M, –∑–Ω–∞—è h.  
   - –§–æ—Ä–º–∞–ª—å–Ω–æ: –ø—Ä–∏ –¥–∞–Ω–Ω–æ–º y = H(M), –≤—ã—á–∏—Å–ª–∏—Ç—å M –ø–æ—á—Ç–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.

2. **Second preimage resistance** (—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫–æ –≤—Ç–æ—Ä–æ–º—É –ø—Ä–æ–æ–±—Ä–∞–∑—É)  
   - –ù–µ–ª—å–∑—è –Ω–∞–π—Ç–∏ M2 ‚â† M1 —Å H(M2) = H(M1).

3. **Collision resistance** (—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –∫–æ–ª–ª–∏–∑–∏—è–º)  
   - –ù–µ–ª—å–∑—è –Ω–∞–π—Ç–∏ *–ª—é–±—ã–µ* M1 ‚â† M2 —Ç–∞–∫–∏–µ, —á—Ç–æ H(M1) = H(M2).  
   - –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: ~2^(n/2) –¥–ª—è n-–±–∏—Ç–Ω–æ–≥–æ —Ö–µ—à–∞ (–∞—Ç–∞–∫–∞ ¬´–¥–Ω—è —Ä–æ–∂–¥–µ–Ω–∏—è¬ª).

---

## üîπ –ó–∞—á–µ–º –Ω—É–∂–Ω—ã —Ö–µ—à–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ (–ø–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–∞ + –µ–≥–æ —Ö–µ—à).  
- ‚úÖ –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∏ (–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Ö–µ—à, –∞ –Ω–µ —Å–∞–º–æ —Å–æ–æ–±—â–µ–Ω–∏–µ).  
- ‚ùå –ù–µ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è: —Ö–µ—à –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.

---

## üîπ –ü—Ä–æ—Å—Ç—ã–µ —Ö–µ—à–∏ (—É—Å—Ç–∞—Ä–µ–≤—à–∏–µ)
### 1. –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–æ–≤
- –î–µ–ª–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ –±–ª–æ–∫–∏ –∏ —Å–∫–ª–∞–¥—ã–≤–∞–µ–º –∏—Ö (mod n).
- –ü—Ä–∏–º–µ—Ä: `72+69+76+76+79 = 372 ‚Üí 116 (mod 256)`.
- ‚ùå –ú–æ–∂–Ω–æ –ø–µ—Ä–µ—Å—Ç–∞–≤–∏—Ç—å –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–∞–∫, —á—Ç–æ–±—ã —Å—É–º–º–∞ —Å–æ–≤–ø–∞–ª–∞.

### 2. XOR –±–ª–æ–∫–æ–≤
- –í—Å–µ –±–ª–æ–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ XOR.  
- –ü—Ä–∏–º–µ—Ä: `10101010 ‚äï 11110000 = 01011010`.  
- ‚ùå –õ–µ–≥–∫–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å: –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –¥–≤–∞ –±–ª–æ–∫–∞.

### 3. CRC (—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π –∫–æ–¥)
- –î–µ–ª–µ–Ω–∏–µ –ø–æ–ª–∏–Ω–æ–º–æ–≤ –ø–æ –º–æ–¥—É–ª—é 2.  
- –û—Ç–ª–∏—á–Ω–æ –ª–æ–≤–∏—Ç —Å–ª—É—á–∞–π–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ —Å–µ—Ç–∏ –∏–ª–∏ —Ñ–∞–π–ª–∞—Ö (Ethernet, ZIP).  
- ‚ùå –õ–∏–Ω–µ–π–Ω—ã–π ‚Üí –∞—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ CRC —Ç–∞–∫, —á—Ç–æ –æ–Ω–∏ —Å–æ–≤–ø–∞–¥—É—Ç.

---
  
- ‚ùå –≠—Ç–∏ –º–µ—Ç–æ–¥—ã –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –æ—à–∏–±–æ–∫ –ø–µ—Ä–µ–¥–∞—á–∏, –Ω–æ –Ω–µ –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏.

---

## üîπ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
–ü–æ—á—Ç–∏ –≤—Å–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ö–µ—à–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **–∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—É—é —Å—Ö–µ–º—É Merkle‚ÄìDamgard**:
1. –°–æ–æ–±—â–µ–Ω–∏–µ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –±–ª–æ–∫–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã (512 –±–∏—Ç, 1024 –±–∏—Ç).  
2. –ö–∞–∂–¥—ã–π –±–ª–æ–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ–º–ø—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π F (—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –º–∏–Ω–∏-—à–∏—Ñ—Ä).  
3. –í—ã—Ö–æ–¥ –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞ = –≤—Ö–æ–¥ —Å–ª–µ–¥—É—é—â–µ–≥–æ.  
4. –í –∫–æ–Ω—Ü–µ –ø–æ–ª—É—á–∞–µ–º —Ö–µ—à —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä 256 –±–∏—Ç).  

üìå –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:  
- –ï—Å–ª–∏ –Ω–µ —É—Å–ª–æ–∂–Ω—è—Ç—å —Å—Ö–µ–º—É, –≤–æ–∑–Ω–∏–∫–∞–µ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç—å *length extension attack*.  
- –ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –¥–ª—è MAC –Ω—É–∂–µ–Ω HMAC, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ–π H(K||M).

---

## üîπ –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã SHA (Secure Hash Algorithm)

### SHA-1
- –î–ª–∏–Ω–∞ –¥–∞–π–¥–∂–µ—Å—Ç–∞: 160 –±–∏—Ç.
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –±–ª–æ–∫–∏ –ø–æ 512 –±–∏—Ç.
- –£—è–∑–≤–∏–º: –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–ª–∏–∑–∏–∏ –Ω–∞–π–¥–µ–Ω—ã (Google SHAttered, 2017).
- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –Ω–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º.

### SHA-2 (SHA-224, SHA-256, SHA-384, SHA-512)
- –ù–∞–¥—ë–∂–Ω–æ–µ —Å–µ–º–µ–π—Å—Ç–≤–æ, —Å—Ç–∞–Ω–¥–∞—Ä—Ç –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.
- –†–∞–∑–º–µ—Ä –¥–∞–π–¥–∂–µ—Å—Ç–∞:
  - SHA-224 ‚Üí 224 –±–∏—Ç–∞  
  - SHA-256 ‚Üí 256 –±–∏—Ç  
  - SHA-384 ‚Üí 384 –±–∏—Ç–∞  
  - SHA-512 ‚Üí 512 –±–∏—Ç
- –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞: 512 –±–∏—Ç (SHA-224/256) –∏–ª–∏ 1024 –±–∏—Ç–∞ (SHA-384/512).
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (K0‚Ä¶Kn), –±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (œÉ, Œ£), –ø–æ–±–∏—Ç–æ–≤—ã–µ —Å–¥–≤–∏–≥–∏ –∏ XOR.

### SHA-512 (–ø—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
- –î–µ–ª–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ –±–ª–æ–∫–∏ –ø–æ 1024 –±–∏—Ç–∞.
- –†–∞–±–æ—Ç–∞–µ—Ç —Å 8 —Å–ª–æ–≤–∞–º–∏ –ø–æ 64 –±–∏—Ç–∞ (a‚Äìh).
- –ö–∞–∂–¥—ã–π —Ä–∞—É–Ω–¥ –æ–±–Ω–æ–≤–ª—è–µ—Ç a‚Äìh —á–µ—Ä–µ–∑ –ø–æ–±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ + –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã Kt + —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ Wt.
- –í—Å–µ–≥–æ 80 —Ä–∞—É–Ω–¥–æ–≤ –Ω–∞ –±–ª–æ–∫.
- –í—ã—Ö–æ–¥ = –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è a‚Äìh –ø–æ—Å–ª–µ –≤—Å–µ—Ö –±–ª–æ–∫–æ–≤ ‚Üí 512-–±–∏—Ç–Ω—ã–π —Ö–µ—à.

---

## üîπ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã
- –î–ª—è –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ (TLS, IPsec, SSH) ‚Üí –±—Ä–∞—Ç—å SHA-256 –∏–ª–∏ SHA-512.  
- –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PBKDF2/Scrypt/Argon2 (SHA ¬´–∫–∞–∫ –µ—Å—Ç—å¬ª –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç).  
- –î–ª—è MAC ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ HMAC (–∏–Ω–∞—á–µ —É—è–∑–≤–∏–º–æ—Å—Ç—å).  
- –î–ª—è –ø–æ–¥–ø–∏—Å–∏ ‚Üí –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç –∏–º–µ–Ω–Ω–æ —Ö–µ—à, –∞ –Ω–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.  

---

## üîπ –ö—Ä–∞—Ç–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
| –ê–ª–≥–æ—Ä–∏—Ç–º | –†–∞–∑–º–µ—Ä —Ö–µ—à–∞ | –°—Ç–∞—Ç—É—Å |
|----------|-------------|--------|
| MD5      | 128 –±–∏—Ç     | ‚ùå –õ–æ–º–∞–µ—Ç—Å—è (–∫–æ–ª–ª–∏–∑–∏–∏) |
| SHA-1    | 160 –±–∏—Ç     | ‚ùå –õ–æ–º–∞–µ—Ç—Å—è (–∫–æ–ª–ª–∏–∑–∏–∏) |
| SHA-224  | 224 –±–∏—Ç     | ‚úÖ –ù–∞–¥—ë–∂–µ–Ω |
| SHA-256  | 256 –±–∏—Ç     | ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç, —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| SHA-384  | 384 –±–∏—Ç     | ‚úÖ –£—Å–∏–ª–µ–Ω–Ω—ã–π |
| SHA-512  | 512 –±–∏—Ç     | ‚úÖ –£—Å–∏–ª–µ–Ω–Ω—ã–π, –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ |

---

‚ö° **–ì–ª–∞–≤–Ω–æ–µ –∏–∑ 3.2:**  
- –•–µ—à–∏ = –æ—Å–Ω–æ–≤–∞ –¥–ª—è MAC, –ø–æ–¥–ø–∏—Å–∏ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π.    
- –ü—Ä–æ—Å—Ç—ã–µ —Ö–µ—à–∏ (XOR, CRC) –Ω–µ–Ω–∞–¥—ë–∂–Ω—ã.  
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ SHA-2 (256/512) –±–µ–∑–æ–ø–∞—Å–Ω—ã.  
- –£—è–∑–≤–∏–º–æ—Å—Ç—å length extension ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º HMAC –¥–ª—è MAC.

  # üìò –ì–ª–∞–≤–∞ 3.3 ‚Äî Message Authentication Codes (MAC)

---

## üîπ –ß—Ç–æ —Ç–∞–∫–æ–µ MAC
**Message Authentication Code (MAC)** = —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞:  


- `M` = —Å–æ–æ–±—â–µ–Ω–∏–µ  
- `K` = —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á  
- `MAC` = –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–≥ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã  

**MAC –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:**
- ‚úÖ –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å ‚Äî –¥–∞–Ω–Ω—ã–µ –Ω–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã  
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –≤–ª–∞–¥–µ–µ—Ç –∫–ª—é—á–æ–º  

---

## üîπ 3.3.1 HMAC (Hash-based MAC)

**–ò–¥–µ—è:** –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –ª—é–±—É—é –∫—Ä–∏–ø—Ç–æ-—Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏—é (SHA-256, SHA-512) –≤ MAC.  
–°—Ç–∞–Ω–¥–∞—Ä—Ç: **RFC 2104** (1996).  

### –ê–ª–≥–æ—Ä–∏—Ç–º
1. –ï—Å–ª–∏ –¥–ª–∏–Ω–∞ –∫–ª—é—á–∞ K > b (—Ä–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ —Ö–µ—à–∞) ‚Üí K = H(K).  
2. –î–æ–ø–æ–ª–Ω–∏—Ç—å K –Ω—É–ª—è–º–∏ –¥–æ –¥–ª–∏–Ω—ã –±–ª–æ–∫–∞ b.  
3. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å:
   - `ipad = 0x36...` (–∑–∞–ø–æ–ª–Ω–∏—Ç—å –¥–æ b –±–∞–π—Ç)  
   - `opad = 0x5C...`  
4. –í—ã—á–∏—Å–ª–∏—Ç—å:
HMAC(K, M) = H( (K ‚äï opad) || H((K ‚äï ipad) || M) )

### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ
- Inner hash = `H((K‚äïipad) || M)`  
- Outer hash = `H((K‚äïopad) || InnerHash)`  
- ipad/opad ‚Üí —Å–æ–∑–¥–∞—é—Ç –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö ¬´–ø–æ–¥–∫–ª—é—á–∞¬ª –∏–∑ K.  

### –ó–∞—á–µ–º —Ç–∞–∫ –Ω—É–∂–Ω–æ?
- –ü—Ä–æ—Å—Ç–∞—è —Å—Ö–µ–º–∞ `H(K||M)` —É—è–∑–≤–∏–º–∞ –∫ *length extension attack*.  
- –î–≤–æ–π–Ω–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å ipad/opad –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç —ç—Ç–æ–≥–æ.  

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
- TLS, IPsec, SSH, API-—Ç–æ–∫–µ–Ω—ã.  

---



