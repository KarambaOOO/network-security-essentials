# 5.1 –°–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—é Web‚Äë–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (Web Security Considerations)

## –û–±—â–∏–π –æ–±–∑–æ—Ä

World Wide Web ‚Äî —ç—Ç–æ –∫–ª–∏–µ–Ω—Ç/—Å–µ—Ä–≤–µ—Ä–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —Ä–∞–±–æ—Ç–∞—é—â–µ–µ –ø–æ–≤–µ—Ä—Ö –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏ TCP/IP‚Äë–∏–Ω—Ç—Ä–∞–Ω–µ—Ç–æ–≤. –•–æ—Ç—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã —Å–µ—Ç–µ–≤–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–∏–º—ã –∏ –∑–¥–µ—Å—å, Web –¥–æ–±–∞–≤–ª—è–µ—Ç **—Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —É–≥—Ä–æ–∑—ã –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏**.

## –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Web

* **–ò–Ω—Ç–µ—Ä–Ω–µ—Ç ‚Äî –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –∫–∞–Ω–∞–ª.** –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å—Ç–∞—Ä—ã—Ö –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Å–∏—Å—Ç–µ–º (—Ç–µ–ª–µ—Ç–µ–∫—Å—Ç, –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç—á–∏–∫–∏, —Ñ–∞–∫—Å‚Äëback), Web‚Äë—Å–µ—Ä–≤–µ—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å –∞—Ç–∞–∫–æ–≤–∞–Ω—ã –∏–∑–≤–Ω–µ.
* **–í—ã—Å–æ–∫–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å.** Web‚Äë—Å—Ç—Ä–∞–Ω–∏—Ü—ã ‚Äî —ç—Ç–æ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –≤–∏—Ç—Ä–∏–Ω–∞. –í–∑–ª–æ–º –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ—Ç–µ—Ä–µ —Ä–µ–ø—É—Ç–∞—Ü–∏–∏ –∏ –¥–µ–Ω–µ–∂–Ω—ã–º –ø–æ—Ç–µ—Ä—è–º.
* **–°–ª–æ–∂–Ω–æ—Å—Ç—å –ü–û.** Web‚Äë—Å–µ—Ä–≤–µ—Ä—ã, –±—Ä–∞—É–∑–µ—Ä—ã –∏ Web‚Äë–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–æ—Å—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–æ —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ —Å–ª–æ–∂–Ω—ã –≤–Ω—É—Ç—Ä–∏ ‚Üí —ç—Ç–æ —Å–∫—Ä—ã–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.
* **–¢–æ—á–∫–∞ –æ–ø–æ—Ä—ã –¥–ª—è –∞—Ç–∞–∫.** –°–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Web‚Äë—Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç –¥–∞—Ç—å –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É –¥–æ—Å—Ç—É–ø –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å–µ—Ç–∏.
* **–ù–µ–æ–±—É—á–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏.** –û–±—ã—á–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã Web‚Äë—Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–µ –∑–Ω–∞—é—Ç –æ —Ä–∏—Å–∫–∞—Ö –∏ –Ω–µ –º–æ–≥—É—Ç –∑–∞—â–∏—â–∞—Ç—å—Å—è.

---

# –¢–∏–ø—ã —É–≥—Ä–æ–∑ Web (Web Security Threats)

–£–≥—Ä–æ–∑—ã –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –ø–æ –¥–≤—É–º –≥—Ä—É–ø–ø–∞–º:

## **1. –ü–∞—Å—Å–∏–≤–Ω—ã–µ –∞—Ç–∞–∫–∏ (Passive Attacks)**

* –ü—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ –º–µ–∂–¥—É –±—Ä–∞—É–∑–µ—Ä–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º.
* –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–∫—Ä—ã—Ç–∞.

## **2. –ê–∫—Ç–∏–≤–Ω—ã–µ –∞—Ç–∞–∫–∏ (Active Attacks)**

* –ò–º–ø–µ—Ä—Å–æ–Ω–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (impersonation).
* –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º.
* –ü–æ–¥–º–µ–Ω–∞ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ Web‚Äë—Å–µ—Ä–≤–µ—Ä–µ.

## **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –º–µ—Å—Ç—É —É–≥—Ä–æ–∑—ã**

| –õ–æ–∫–∞—Ü–∏—è —É–≥—Ä–æ–∑—ã  | –ü—Ä–∏–º–µ—Ä—ã                                             |
| --------------- | --------------------------------------------------- |
| **Web —Å–µ—Ä–≤–µ—Ä**  | –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –ü–û —Å–µ—Ä–≤–µ—Ä–∞, –≤–∑–ª–æ–º CMS, –ø–æ–¥–º–µ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü |
| **Web –±—Ä–∞—É–∑–µ—Ä** | XSS, –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã, —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π     |
| **–¢—Ä–∞—Ñ–∏–∫**      | MITM, –ø–µ—Ä–µ—Ö–≤–∞—Ç, –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–∞–∫–µ—Ç–æ–≤                 |

---

# –ü–æ–¥—Ö–æ–¥—ã –∫ –∑–∞—â–∏—Ç–µ Web‚Äë—Ç—Ä–∞—Ñ–∏–∫–∞ (Web Traffic Security Approaches)

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Web‚Äë—Ç—Ä–∞—Ñ–∏–∫–∞. –û–Ω–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è **—É—Ä–æ–≤–Ω–µ–º TCP/IP‚Äë—Å—Ç–µ–∫–∞**, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —Ä–∞–±–æ—Ç–∞—é—Ç.

---

# 1. –£—Ä–æ–≤–µ–Ω—å —Å–µ—Ç–∏ ‚Äî **IPsec** (Network Level Security)

–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ **IP**.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

* –ü—Ä–æ–∑—Ä–∞—á–Ω–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.
* –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –∑–∞—â–∏—Ç—ã.
* –ú–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ (–Ω–µ –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ –¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏ —á–µ—Ä–µ–∑ IPsec).
  
---

# 2. –£—Ä–æ–≤–µ–Ω—å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ ‚Äî **SSL/TLS** (Transport Level Security)

–†–∞–±–æ—Ç–∞–µ—Ç **–Ω–∞–¥ TCP**, –Ω–æ –ø–æ–¥ HTTP/SMTP/FTP.

### –ü—Ä–∏–º–µ—Ä—ã:

* **SSL (Secure Sockets Layer)**
* **TLS (Transport Layer Security)** ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç

### –î–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

1. –ö–∞–∫ —á–∞—Å—Ç—å —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Å—Ç–µ–∫–∞ (–ø—Ä–æ–∑—Ä–∞—á–Ω–æ).
2. –ö–∞–∫ —á–∞—Å—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±—Ä–∞—É–∑–µ—Ä—ã —É–∂–µ –≤–∫–ª—é—á–∞—é—Ç TLS).


---

# 3. –£—Ä–æ–≤–µ–Ω—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π ‚Äî Application‚ÄëLevel Security

–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–∞ –≤ —Å–∞–º–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

### –ü—Ä–∏–º–µ—Ä—ã:

* **S/MIME** ‚Äî —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –ø–∏—Å–µ–º
* **Kerberos** ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
* –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ Web‚Äë–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è


### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:

* –†–µ—à–µ–Ω–∏–µ –º–æ–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

# –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–¥—Ö–æ–¥–æ–≤

| –£—Ä–æ–≤–µ–Ω—å               | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏                     | –û–ø–∏—Å–∞–Ω–∏–µ                                                  |
| --------------------- | ------------------------------ | --------------------------------------------------------- |
| **Network Level**     | IPsec                          | –ó–∞—â–∏—Ç–∞ –≤—Å–µ–≥–æ IP‚Äë—Ç—Ä–∞—Ñ–∏–∫–∞; –ø—Ä–æ–∑—Ä–∞—á–Ω–æ; –æ–±—â–∏–π –ø–æ–¥—Ö–æ–¥          |
| **Transport Level**   | SSL/TLS                        | –ó–∞—â–∏—Ç–∞ TCP‚Äë–ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ (HTTPS, SMTPS); —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| **Application Level** | S/MIME, Kerberos, app‚Äësecurity | –ì–∏–±–∫–∞—è –∑–∞—â–∏—Ç–∞ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ                   |

---

# –ò—Ç–æ–≥

Web‚Äë–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö. –ö–æ—Ä–ø–æ—Ä–∞—Ü–∏–∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, **IPsec + TLS**). –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Å–Ω–æ–≤–æ–π —è–≤–ª—è–µ—Ç—Å—è **TLS (HTTPS)**, –∞ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–µ—Ç–∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IPsec –¥–ª—è –∑–∞—â–∏—Ç—ã –≤—Å–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.


# –ì–ª–∞–≤–∞ 5.2 ‚Äî SSL –∏ TLS 

**–¶–µ–ª—å:** –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç SSL/TLS: —á—Ç–æ —Ç–∞–∫–æ–µ Session/Connection, Handshake, Record Protocol, –∫–ª—é—á–∏ –∏ –∑–∞—á–µ–º –≤–æ–æ–±—â–µ –Ω—É–∂–Ω–∞ —ç—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞. 
---

## ‚≠ê 1. –ß—Ç–æ —Ç–∞–∫–æ–µ SSL/TLS

- **SSL** ‚Äî —Å—Ç–∞—Ä—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–æ—Ç Netscape).  
- **TLS** ‚Äî –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –æ—Ç IETF (TLS 1.0 ‚âà SSL 3.1).  
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ HTTPS, –ø–æ—á—Ç–æ–≤—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–∞—Ö –∏ –ª—é–±–æ–º –∑–∞—â–∏—â—ë–Ω–Ω–æ–º TCP-—Ç—Ä–∞—Ñ–∏–∫–µ.

> –ò–¥–µ—è: —Å–æ–∑–¥–∞—Ç—å –Ω–∞–¥ TCP –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π, –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π –∫–∞–Ω–∞–ª —Å–≤—è–∑–∏.

# ‚≠ê 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ SSL (Figure 5.2)

<img width="459" height="308" alt="image" src="https://github.com/user-attachments/assets/12b47a4b-78a5-4083-bed1-21015aaef6c8" />


---

# ‚≠ê 3. –ü—Ä–æ—Ç–æ–∫–æ–ª—ã –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è

–í—Å–µ —ç—Ç–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –ø—Ä–æ—Ö–æ–¥—è—Ç **—á–µ—Ä–µ–∑ SSL Record Protocol**.

---

## üîπ 3.1 SSL Handshake Protocol

–ì–ª–∞–≤–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª SSL.

–§—É–Ω–∫—Ü–∏–∏:
- —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç SSL **session**,
- –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Å–µ—Ä–≤–µ—Ä (–∏ –∫–ª–∏–µ–Ω—Ç–∞, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ),
- –≤—ã–±–∏—Ä–∞–µ—Ç –≤–µ—Ä—Å–∏—é SSL/TLS,
- –≤—ã–±–∏—Ä–∞–µ—Ç **cipher suite**,
- –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `pre_master_secret`,
- —Å–æ–∑–¥–∞—ë—Ç `master_secret`,
- —Å–æ–∑–¥–∞—ë—Ç –≤—Å–µ –∫–ª—é—á–∏ –¥–ª—è **connection**.

> Handshake = —Å–æ–∑–¥–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ + –∫–ª—é—á–µ–π.

---

## üîπ 3.2 SSL Change Cipher Spec Protocol

–ú–∏–Ω–∏–∞—Ç—é—Ä–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª, –Ω–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π.

–§—É–Ω–∫—Ü–∏—è:
- –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å **pending** ‚Üí **current**,
- –≥–æ–≤–æ—Ä–∏—Ç: ‚Äú–¢–µ–ø–µ—Ä—å —à–∏—Ñ—Ä—É–µ–º –Ω–æ–≤—ã–º–∏ –∫–ª—é—á–∞–º–∏‚Äù.

–°–æ–æ–±—â–µ–Ω–∏–π —Ä–æ–≤–Ω–æ –æ–¥–Ω–æ:
change_cipher_spec


> –ë–µ–∑ –Ω–µ–≥–æ connection –Ω–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º.

---

## üîπ 3.3 SSL Alert Protocol

–°–æ–æ–±—â–∞–µ—Ç –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö –≤ SSL.

–°–æ–¥–µ—Ä–∂–∏—Ç 2 –±–∞–π—Ç–∞:
1) —É—Ä–æ–≤–µ–Ω—å (`warning` –∏–ª–∏ `fatal`)  
2) —Ç–∏–ø –æ—à–∏–±–∫–∏

–ü—Ä–∏–º–µ—Ä—ã `fatal`:
- bad_record_mac  
- handshake_failure  
- illegal_parameter  

–ü—Ä–∏–º–µ—Ä—ã `warning`:
- close_notify  
- bad_certificate  
- certificate_expired  

> fatal ‚Üí —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è.

---

## üîπ 3.4 Application Protocol (–Ω–∞–ø—Ä–∏–º–µ—Ä, HTTP)

HTTP –∏–ª–∏ –¥—Ä—É–≥–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö SSL Record Protocol.  
–ö–æ–≥–¥–∞ –ø–æ–≤–µ—Ä—Ö SSL –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è HTTP ‚Üí –ø–æ–ª—É—á–∞–µ—Ç—Å—è **HTTPS**.

---

# ‚≠ê 4. SSL Record Protocol (–æ—Å–Ω–æ–≤–Ω–æ–π —Ä–∞–±–æ—á–∏–π —É—Ä–æ–≤–µ–Ω—å)

–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞:
- —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö (–¥–æ 16 KB),
- (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ) —Å–∂–∞—Ç–∏–µ,
- –≥–µ–Ω–µ—Ä–∞—Ü–∏—é MAC,
- —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ,
- –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞,
- –ø–µ—Ä–µ–¥–∞—á—É —á–µ—Ä–µ–∑ TCP.

–ù–∞ –ø—Ä–∏—ë–º–µ:
- —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞,
- –ø—Ä–æ–≤–µ—Ä–∫–∞ MAC,
- —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞,
- —Å–±–æ—Ä–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è.

> Record Protocol = —É–ø–∞–∫–æ–≤—â–∏–∫, —à–∏—Ñ—Ä–æ–≤–∞–ª—å—â–∏–∫ –∏ –ø—Ä–æ–≤–µ—Ä—è–ª—å—â–∏–∫ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏.

---

# ‚≠ê 5. TCP –∏ IP —É—Ä–æ–≤–Ω–∏

## üîπ TCP  
–î–µ–ª–∞–µ—Ç:
- –Ω–∞–¥—ë–∂–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É,
- –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö,
- –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—Ä—è–¥–∫–∞.

SSL **–≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö TCP**.

## üîπ IP  
–î–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–∞–∫–µ—Ç—ã –º–µ–∂–¥—É —Ö–æ—Å—Ç–∞–º–∏ –ø–æ —Å–µ—Ç–∏.

---

# ‚≠ê 6. Session vs Connection (–∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –ª–æ–≥–∏–∫–∞)

–≠–¢–û –ù–ï –£–†–û–í–ù–ò –°–¢–ï–ö–ê ‚Äî —ç—Ç–æ **–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è** SSL.

---

## üîπ SESSION

–°–æ–∑–¥–∞—ë—Ç—Å—è –≤ Handshake.  
–°–æ–¥–µ—Ä–∂–∏—Ç –æ–±—â–∏–µ –∫—Ä–∏–ø—Ç–æ–ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

- Session ID  
- —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞  
- compression method  
- cipher spec (AES, SHA1 –∏ —Ç.–¥.)  
- **master_secret (48 bytes)**  
- —Ñ–ª–∞–≥ ‚Äúresumable‚Äù

> Session –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –Ω–æ–≤—ã–µ connections –±–µ–∑ –Ω–æ–≤–æ–≥–æ handshake.

---

## üîπ CONNECTION

–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.  
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã session + —Å–æ–∑–¥–∞—ë—Ç —Å–≤–æ–∏:

- client_random / server_random  
- client_write_key  
- server_write_key  
- client_write_MAC  
- server_write_MAC  
- IV (–¥–ª—è CBC)  
- sequence numbers

> Connection = ¬´—Ä–∞–±–æ—á–∏–µ¬ª –∫–ª—é—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ Record Protocol.

---

# ‚≠ê 7. –ì–ª–∞–≤–Ω–æ–µ –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ

> **Handshake —Å–æ–∑–¥–∞—ë—Ç Session –∏ Connection,  
> Change Cipher Spec –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç Connection,  
> Alert —Å–æ–æ–±—â–∞–µ—Ç –æ—à–∏–±–∫–∏,  
> Record Protocol —à–∏—Ñ—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ,  
> TCP/IP –ø–µ—Ä–µ–¥–∞—é—Ç –∏—Ö –≤ —Å–µ—Ç—å.**

---

# ‚≠ê 8. –°—É–ø–µ—Ä–∫—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ 

- SSL —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤.  
- Handshake = –≤—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–µ–π, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è.  
- Change Cipher Spec = –≤–∫–ª—é—á–µ–Ω–∏–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è.  
- Alert = –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è / –æ—à–∏–±–∫–∏.  
- Record Protocol = —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ MAC.  
- Session = –æ–±—â–∏–π –∫—Ä–∏–ø—Ç–æ–∫–æ–Ω—Ç–µ–∫—Å—Ç.  
- Connection = –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.  
- HTTP —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö SSL ‚Üí HTTPS.

# 5.3 ‚Äî Transport Layer Security (—à–ø–∞—Ä–≥–∞–ª–∫–∞)

**–¶–µ–ª—å:** –ø–æ–Ω—è—Ç—å, —á–µ–º TLS –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç SSLv3 –∏ –ø–æ—á–µ–º—É TLS —Å—Ç–∞–ª —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º.

---

# ‚≠ê 1. –ß—Ç–æ —Ç–∞–∫–æ–µ TLS

TLS ‚Äî —ç—Ç–æ —ç–≤–æ–ª—é—Ü–∏—è SSLv3, —Å–æ–∑–¥–∞–Ω–Ω–∞—è IETF.  
–ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è TLS = **TLS 1.0**, –ø–æ —Å—É—Ç–∏ **SSLv3.1** (–ø–æ—á—Ç–∏ —Ç–æ –∂–µ —Å–∞–º–æ–µ).

–ö–ª—é—á–µ–≤–∞—è —Ü–µ–ª—å TLS:
- —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å SSL,
- —É–ª—É—á—à–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å,
- –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ SSLv3.

---

# ‚≠ê 2. –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å TLS —Å SSLv3

- TLS 1.0 –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –±–∞–∑–µ SSLv3.  
- –ü—Ä–æ—Ç–æ–∫–æ–ª—ã –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–∏.  
- –í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ TLS –∏ SSLv3 **—Å–æ–≤–º–µ—Å—Ç–∏–º—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–æ–æ–±—â–µ–Ω–∏–π**.  
- –ù–æ TLS –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º ‚Äî –µ—Å—Ç—å –æ—Ç–ª–∏—á–∏—è –≤:
  - —Ñ–æ—Ä–º–∞—Ç–∞—Ö MAC,
  - –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π,
  - –Ω–∞–±–æ—Ä–∞—Ö —à–∏—Ñ—Ä–æ–≤.

---

# ‚≠ê 3. –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Ç–ª–∏—á–∏—è TLS –æ—Ç SSLv3

–ù–∏–∂–µ ‚Äî —Ç–æ–ª—å–∫–æ —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ (–∫–∞–∫ –≤ –∫–Ω–∏–≥–µ Stallings):

---

## üîπ 3.1 Stronger MAC (HMAC –≤–º–µ—Å—Ç–æ SSLv3-MAC)

SSLv3 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π MAC (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π).

TLS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **HMAC** (RFC 2104):

- –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ,
- –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –Ω–∞–¥—ë–∂–Ω–µ–µ,
- —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω.

> –≠—Ç–æ –æ–¥–Ω–æ –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π TLS.

---

## üîπ 3.2 –†–∞–∑–ª–∏—á–∏—è –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π

TLS –º–µ–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:

- **master_secret**
- **key_block**

TLS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å—Ç—Ä–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é PRF** (Pseudo-Random Function),  
–∫–æ—Ç–æ—Ä–∞—è –∫–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç MD5 –∏ SHA-1 —á–µ—Ä–µ–∑ XOR:

PRF(secret, label, seed) =
P_MD5(secret, label + seed) XOR
P_SHA-1(secret, label + seed)


SSLv3 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –¥—Ä—É–≥–æ–π –º–µ—Ö–∞–Ω–∏–∑–º.

---

## üîπ 3.3 –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —à–∏—Ñ—Ä–æ—Å—å—é—Ç–æ–≤

TLS:
- –≤–≤—ë–ª –Ω–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã,  
- –∑–∞–ø—Ä–µ—Ç–∏–ª —Å–ª–∞–±—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã,  
- —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–ª —Ñ–æ—Ä–º–∞—Ç CipherSuite.

SSLv3 –∏–º–µ–ª –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫.

---

## üîπ 3.4 –ê–ª–≥–æ—Ä–∏—Ç–º—ã –∫–æ–º–ø—Ä–µ—Å—Å–∏–∏

TLS —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Å–∂–∞—Ç–∏—è.  
–í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ ‚Äî **–ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ null**.

---

## üîπ 3.5 –ê–ª–≥–æ—Ä–∏—Ç–º—ã Alert Protocol

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ Alert-–∫–æ–¥—ã –∏–∑–º–µ–Ω–µ–Ω—ã –∏–ª–∏ —É–¥–∞–ª–µ–Ω—ã.  
–ß–∞—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∞.

---

## üîπ 3.6 –†–∞–∑–ª–∏—á–∏—è –≤ Finished message

TLS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PRF –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è Finished.  
SSLv3 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –¥—Ä—É–≥–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º.

---

# ‚≠ê 4. –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –º–µ–∂–¥—É SSLv3 –∏ TLS

- —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π Handshake,  
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Record Protocol,  
- –ø–æ–Ω—è—Ç–∏—è session –∏ connection,  
- –ª–æ–≥–∏–∫–∞ ClientHello / ServerHello,  
- –æ–±—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏.

---

# ‚≠ê 5. –ü–æ—á–µ–º—É TLS ‚Üí —Å—Ç–∞–Ω–¥–∞—Ä—Ç, –∞ SSL —É–º–µ—Ä

–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:

- SSLv3 —É—è–∑–≤–∏–º (POODLE, BEAST –∏ –¥—Ä.)  
- SSLv3 –∏–º–µ–µ—Ç —Å–ª–∞–±—ã–π MAC  
- —Å–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä—ã–µ —à–∏—Ñ—Ä—ã  
- –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º  

–°–µ–≥–æ–¥–Ω—è:
- SSLv2/SSLv3 **–∑–∞–ø—Ä–µ—â–µ–Ω—ã**  
- –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è ‚Äî TLS 1.2  
- —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è ‚Äî TLS 1.3

---

# ‚≠ê 6. –ö–æ—Ä–æ—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

- TLS = —É–ª—É—á—à–µ–Ω–Ω—ã–π SSLv3  
- –±–µ–∑–æ–ø–∞—Å–Ω—ã–π MAC = HMAC  
- —É–ª—É—á—à–µ–Ω–Ω–∞—è PRF –¥–ª—è –∫–ª—é—á–µ–π  
- –±–æ–ª—å—à–µ —à–∏—Ñ—Ä–æ–≤  
- —É–ª—É—á—à–µ–Ω–Ω—ã–π Alert Protocol  
- –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç  
- SSLv3 ‚âà —É—Å—Ç–∞—Ä–µ–≤—à–∏–π, TLS = —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª

---

# ‚≠ê 7. –í –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É

> **TLS ‚Äî —ç—Ç–æ SSLv3 –±–µ–∑ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∫–æ—Å—è–∫–æ–≤.**


# 5.4 ‚Äî HTTPS (—à–ø–∞—Ä–≥–∞–ª–∫–∞)

**HTTPS = HTTP –ø–æ–≤–µ—Ä—Ö SSL/TLS.**  
–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∑–∞—â–∏—â—ë–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É –±—Ä–∞—É–∑–µ—Ä–æ–º –∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–º.

---

# ‚≠ê 1. –ß—Ç–æ —Ç–∞–∫–æ–µ HTTPS

- –≠—Ç–æ –æ–±—ã—á–Ω—ã–π HTTP, –Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–π –∫–∞–∫ **TLS Application Data**.  
- –ë—Ä–∞—É–∑–µ—Ä ‚Üí TLS ‚Üí TCP ‚Üí IP.  
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤—Å–µ–º–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏.  
- –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å HTTPS, –∏–Ω–∞—á–µ https:// –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

### –û—Ç–ª–∏—á–∏—è:
- **http:// ‚Üí –ø–æ—Ä—Ç 80**  
- **https:// ‚Üí –ø–æ—Ä—Ç 443 (–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç SSL/TLS)**

---

# ‚≠ê 2. –ß—Ç–æ —à–∏—Ñ—Ä—É–µ—Ç—Å—è –≤ HTTPS

–í—Å—ë, —á—Ç–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ HTTP:

- URL (–ø—É—Ç—å + –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
- —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –¥–∞–Ω–Ω—ã–µ HTML-—Ñ–æ—Ä–º
- cookies (–≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã)
- HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏

> –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ, —á—Ç–æ *–Ω–µ* —à–∏—Ñ—Ä—É–µ—Ç—Å—è ‚Äî IP/–ø–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Ñ–∞–∫—Ç, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HTTPS.

---

# ‚≠ê 3. –°—Ç–∞–Ω–¥–∞—Ä—Ç

HTTPS –æ–ø–∏—Å–∞–Ω –≤ **RFC 2818 (HTTP Over TLS)**.  
–ù–µ—Ç —Ä–∞–∑–Ω–∏—Ü—ã: HTTP over SSL –∏–ª–∏ HTTP over TLS ‚Äî **—ç—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è HTTPS**.

---

# ‚≠ê 4. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (Connection Initiation)

–í HTTPS **–∫–ª–∏–µ–Ω—Ç –ø–æ —Å—É—Ç–∏ = TLS –∫–ª–∏–µ–Ω—Ç**.

–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

1. –ö–ª–∏–µ–Ω—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–∞ –ø–æ—Ä—Ç 443.  
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç **TLS ClientHello** ‚Üí –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è TLS Handshake.  
3. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ handshake:  
   ‚Üí –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç **–ø–µ—Ä–≤—ã–π HTTP –∑–∞–ø—Ä–æ—Å**, –Ω–æ —É–∂–µ –≤–Ω—É—Ç—Ä–∏ TLS.  
4. –í–µ—Å—å HTTP-—Ç—Ä–∞—Ñ–∏–∫ –∏–¥—ë—Ç –∫–∞–∫ **TLS Application Data**.

> HTTP –≤–µ–¥—ë—Ç —Å–µ–±—è –∞–±—Å–æ–ª—é—Ç–Ω–æ –∫–∞–∫ –æ–±—ã—á–Ω–æ ‚Äî –ø—Ä–æ—Å—Ç–æ –ø–æ–≤–µ—Ä—Ö —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞.

---

# ‚≠ê 5. –¢—Ä–∏ —É—Ä–æ–≤–Ω—è ¬´–æ—Å–æ–∑–Ω–∞–Ω–∏—è¬ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤ HTTPS

–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –ø—Ä–∏ HTTPS –µ—Å—Ç—å **3 —É—Ä–æ–≤–Ω—è**:

### 1) HTTP —É—Ä–æ–≤–µ–Ω—å
- –ö–ª–∏–µ–Ω—Ç —Å—á–∏—Ç–∞–µ—Ç, —á—Ç–æ –æ–Ω –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ ‚Äú—Å–µ—Ä–≤–µ—Ä—É HTTP‚Äù.
- –û–Ω –Ω–µ –∑–Ω–∞–µ—Ç, TCP —ç—Ç–æ –∏–ª–∏ TLS –ø–æ–¥ –Ω–∏–º.

### 2) TLS —É—Ä–æ–≤–µ–Ω—å
- TLS —Å–æ–∑–¥–∞—ë—Ç **session** –∏ –º–æ–∂–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ **connections**.  
- –î–ª—è HTTPS –æ–±—ã—á–Ω–æ 1 connection –Ω–∞ –∑–∞–ø—Ä–æ—Å.

### 3) TCP —É—Ä–æ–≤–µ–Ω—å
- TLS –≤—Å–µ–≥–¥–∞ —Å—Ç—Ä–æ–∏—Ç—Å—è –ø–æ–≤–µ—Ä—Ö TCP.  
- TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø–µ—Ä–≤—ã–º.

TLS —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

–ü–æ—Ä—è–¥–æ–∫ —Ç–∞–∫–æ–π:
1) –ö–ª–∏–µ–Ω—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º (–ø–æ—Ä—Ç 443).
2) –í–Ω—É—Ç—Ä–∏ —ç—Ç–æ–≥–æ TCP –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è TLS Handshake.
3) –ü–æ—Å–ª–µ Handshake –≤–µ—Å—å HTTP-—Ç—Ä–∞—Ñ–∏–∫ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–∞–∫ TLS Application Data.

> –ò—Ç–æ–≥: HTTP ‚Üí TLS ‚Üí TCP.

---

# ‚≠ê 6. –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (Connection Closure)

HTTP –∏ TLS –∑–∞–∫—Ä—ã–≤–∞—é—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ-—Ä–∞–∑–Ω–æ–º—É.

---

## üîπ 6.1 –ó–∞–∫—Ä—ã—Ç–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ HTTP

HTTP –º–æ–∂–µ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç—å –∑–∞–∫—Ä—ã—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é:

Connection: close


–ü–æ—Å–ª–µ –¥–æ—Å—Ç–∞–≤–∫–∏ —ç—Ç–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å.

---

## üîπ 6.2 –ó–∞–∫—Ä—ã—Ç–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ TLS (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±)

–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ TLS:

1. –û–¥–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç **close_notify (Alert Protocol)**.  
2. –û–±–µ —Å—Ç–æ—Ä–æ–Ω—ã –¥–æ–ª–∂–Ω—ã –æ–±–º–µ–Ω—è—Ç—å—Å—è close_notify.  
3. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.

> –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –∏–ª–∏ –ø–æ–¥–¥–µ–ª–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è.

### –í–æ–∑–º–æ–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:
TLS –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–≤–æ—ë close_notify  
–∏ **–∑–∞–∫—Ä—ã—Ç—å TCP —Å—Ä–∞–∑—É**, –Ω–µ –æ–∂–∏–¥–∞—è –æ—Ç–≤–µ—Ç.  
–≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è *incomplete close*.

---

## üîπ 6.3 –ï—Å–ª–∏ TCP –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ TLS close_notify

–≠—Ç–æ –ø–ª–æ—Ö–æ:

- –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –æ—à–∏–±–∫–∞,  
- –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–±–æ–π –∫–∞–Ω–∞–ª–∞,  
- **–º–æ–∂–µ—Ç –±—ã—Ç—å –∞—Ç–∞–∫–∞ (MITM / truncation attack)**.

–ü–æ—ç—Ç–æ–º—É HTTPS-–∫–ª–∏–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω **–ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ**.

---

# ‚≠ê 7. –ò—Ç–æ–≥ 

- HTTPS = HTTP —á–µ—Ä–µ–∑ TLS.  
- –ü–æ—Ä—Ç 443, —à–∏—Ñ—Ä—É—é—Ç—Å—è URL/–¥–∞–Ω–Ω—ã–µ/–∑–∞–≥–æ–ª–æ–≤–∫–∏/cookies.  
- –ü–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º HTTP-–∑–∞–ø—Ä–æ—Å–æ–º –≤—Å–µ–≥–¥–∞ –∏–¥—ë—Ç TLS Handshake.  
- HTTP –¥—É–º–∞–µ—Ç, —á—Ç–æ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –æ–±—ã—á–Ω–æ–º—É –∫–∞–Ω–∞–ª—É, –Ω–æ —ç—Ç–æ—Ç –∫–∞–Ω–∞–ª ‚Äî TLS.  
- –ó–∞–∫—Ä—ã–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚Üí —á–µ—Ä–µ–∑ TLS close_notify.  
- –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π TCP FIN = –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ.

---

# ‚≠ê 8. –û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞

> **HTTPS = HTTP + TLS: —à–∏—Ñ—Ä—É–µ—Ç—Å—è –≤—Å—ë, —Å–Ω–∞—á–∞–ª–∞ handshake, –∑–∞—Ç–µ–º HTTP –ª–µ—Ç–∏—Ç –∫–∞–∫ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.**


